{
  "hash": "a25d6aaebb99a41bb3c032757bee770c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Spatial Data\"\nauthor:\n  - name: Marguerite Butler\n    url: https://butlerlab.org\n    affiliation: School of Life Sciences, University of Hawaii\n    affiliation_url: https://manoa.hawaii.edu/lifesciences/\ndescription: \"Mapping in R\"\ndate: 2025-05-01\ncategories: [module 8, week 15, sf, shapefiles, ggplot2, maps]\nbibliography: ../refs.bib\n---\n\n\n\n### Acknowledgements\n\nReferences for this Material:\n\n-  `maps`: https://eriqande.github.io/rep-res-web/lectures/making-maps-with-R.html\n\n\n-  `sf`: https://r-spatial.org/r/2018/10/25/ggplot2-sf.html\n\n# Learning objectives\n\n::: callout-note\n# Learning objectives\n\n**At the end of this lesson you will:**\n\n-   Be familiar with spatial data in r, including using polygons and shapefiles \n-   Understand how to subset and manipulate spatial data\n-   Be able to create maps and data overlays in r\n\n:::\n\n:::{.callout-note}\n#  R packages you will need\n- `maps`\n- `ggmap`\n- `sf`\n- `rnaturalearth`\n- `ggspatial`\n- `grid`\n- `scales`\n- `ggplot2`\n- `dplyr`\n- `magrittr`\n:::\n\n\n# Overview\n\nThere are many great resources to plot maps in R. The first step is to download or access the map information, commonly stored as shape data (type `.shp`) The older `maps` package creates polygons from coordinate data, whereas the `sf` package is used to read and work with shape data.  \n\n## `maps` \n\nDownload states data and explore. It is a pretty simple to get the map data. It is a dataframe with a series of latitude and longitude data for each state. Essentially itʻs the points that define the outline of the state if you connect the dots. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(maps)\nlibrary(ggplot2)\nlibrary(ggmap)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nℹ Google's Terms of Service: <https://mapsplatform.google.com>\n  Stadia Maps' Terms of Service: <https://stadiamaps.com/terms-of-service>\n  OpenStreetMap's Tile Usage Policy: <https://operations.osmfoundation.org/policies/tiles>\nℹ Please cite ggmap if you use it! Use `citation(\"ggmap\")` for details.\n```\n\n\n:::\n\n```{.r .cell-code}\nstates <- map_data(\"state\") # get map data from maps package\ndim(states)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15537     6\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(states)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       long      lat group order  region subregion\n1 -87.46201 30.38968     1     1 alabama      <NA>\n2 -87.48493 30.37249     1     2 alabama      <NA>\n3 -87.52503 30.37249     1     3 alabama      <NA>\n4 -87.53076 30.33239     1     4 alabama      <NA>\n5 -87.57087 30.32665     1     5 alabama      <NA>\n6 -87.58806 30.32665     1     6 alabama      <NA>\n```\n\n\n:::\n\n```{.r .cell-code}\ntail(states)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           long      lat group order  region subregion\n15594 -106.3295 41.00659    63 15594 wyoming      <NA>\n15595 -106.8566 41.01232    63 15595 wyoming      <NA>\n15596 -107.3093 41.01805    63 15596 wyoming      <NA>\n15597 -107.9223 41.01805    63 15597 wyoming      <NA>\n15598 -109.0568 40.98940    63 15598 wyoming      <NA>\n15599 -109.0511 40.99513    63 15599 wyoming      <NA>\n```\n\n\n:::\n:::\n\n\n\nPlot the map data using `geom_polygon` and ggplot, plotting the latitude and longitude (Global Positioning System or GPS coordinates): \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = states) + \n  geom_polygon(     # draw a polygon\n    aes(x = long,   # use GPS coordinates\n        y = lat, \n        fill = region,  # color by states \n        group = group), # group polygons by state\n    color = \"white\") +  # borders are white\n  coord_fixed(1.3) +    # aspect ratio\n  guides(fill=\"none\")  # do this to leave off the color legend\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\nSince `states` it is just a dataframe, it is easy to subset. We can do it many ways, but here is an example using the subset function. This also demonstrates the point nature of the data and why specifying the group is important:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwest_coast <- subset(states, region %in% c(\"california\", \"oregon\", \"washington\", \"hawaii\"))\n\nggplot(data = west_coast) + \n  geom_polygon(\n    aes(x = long,\n        y = lat), \n    fill = \"palegreen\", \n    color = \"black\") \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThatʻs better! In this dataset, `group` indicates the states by number. Now the points belong the states, and arenʻt plotted out of order.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = west_coast) + \n  geom_polygon(\n    aes(x = long, \n        y = lat, \n        group = group), # group by state\n    fill = \"palegreen\", \n    color = \"black\") + \n  coord_fixed(1.3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n### An example zooming in on California \n\nGet the geospatial data by subsetting. Get the county data too\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca_df <- subset(states, region == \"california\")\nhead(ca_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         long      lat group order     region subregion\n667 -120.0060 42.00927     4   667 california      <NA>\n668 -120.0060 41.20139     4   668 california      <NA>\n669 -120.0060 39.70024     4   669 california      <NA>\n670 -119.9946 39.44241     4   670 california      <NA>\n671 -120.0060 39.31636     4   671 california      <NA>\n672 -120.0060 39.16166     4   672 california      <NA>\n```\n\n\n:::\n\n```{.r .cell-code}\ncounties <- map_data(\"county\")\nca_county <- subset(counties, region == \"california\")\nhead(ca_county)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          long      lat group order     region subregion\n6965 -121.4785 37.48290   157  6965 california   alameda\n6966 -121.5129 37.48290   157  6966 california   alameda\n6967 -121.8853 37.48290   157  6967 california   alameda\n6968 -121.8968 37.46571   157  6968 california   alameda\n6969 -121.9254 37.45998   157  6969 california   alameda\n6970 -121.9483 37.47717   157  6970 california   alameda\n```\n\n\n:::\n:::\n\n\n\nLetʻs have a look at the county data. County info is in the `subregion`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca_base <- ggplot(\n              data = ca_df, \n              mapping = aes(\n                              x = long, \n                              y = lat, \n                              group = group)) + \n  coord_fixed(1.3) + \n  geom_polygon(color = \"black\", fill = \"gray\")\n\nca_base + theme_nothing()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nca_base + theme_nothing() + \n  geom_polygon(\n      data = ca_county, # county outlines\n      fill = NA, \n      color = \"white\") +\n  geom_polygon(\n      color = \"black\", \n      fill = NA)  # plot last so border on top layer\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\nTry choosing a county and filling it with a different color.\n\n## `sf` package\n\nThe newer packages work with __shapefiles__, which are data types produced by ArgGIS and other spatial software. There is a lot of shapefile data available on the internet. For example, for Hawaii, see <https://geoportal.hawaii.gov>.\n\nLoad packages:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(magrittr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'magrittr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:ggmap':\n\n    inset\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggspatial)\nlibrary(grid)\n```\n:::\n\n\n\n`rnaturalerth` has a lot of map data already available, all you need to do is subset it to the region you wish to use. \n\n`sf` is a package that reads, writes, and helps you work with shapefiles. \n\n`ggspacial` has some nice add on functions\n\n`grid` adds a rectangular grid to an existing plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nworld <- ne_countries(scale = \"medium\", returnclass = \"sf\")\nclass(world)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sf\"         \"data.frame\"\n```\n\n\n:::\n\n```{.r .cell-code}\nclass(world)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"sf\"         \"data.frame\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(world)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 242 features and 168 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -180 ymin: -89.99893 xmax: 180 ymax: 83.59961\nGeodetic CRS:  WGS 84\nFirst 10 features:\n        featurecla scalerank labelrank                     sovereignt sov_a3\n1  Admin-0 country         1         3                       Zimbabwe    ZWE\n2  Admin-0 country         1         3                         Zambia    ZMB\n3  Admin-0 country         1         3                          Yemen    YEM\n4  Admin-0 country         3         2                        Vietnam    VNM\n5  Admin-0 country         5         3                      Venezuela    VEN\n6  Admin-0 country         6         6                        Vatican    VAT\n7  Admin-0 country         1         4                        Vanuatu    VUT\n8  Admin-0 country         1         3                     Uzbekistan    UZB\n9  Admin-0 country         1         4                        Uruguay    URY\n10 Admin-0 country         3         6 Federated States of Micronesia    FSM\n   adm0_dif level              type tlc                          admin adm0_a3\n1         0     2 Sovereign country   1                       Zimbabwe     ZWE\n2         0     2 Sovereign country   1                         Zambia     ZMB\n3         0     2 Sovereign country   1                          Yemen     YEM\n4         0     2 Sovereign country   1                        Vietnam     VNM\n5         0     2 Sovereign country   1                      Venezuela     VEN\n6         0     2 Sovereign country   1                        Vatican     VAT\n7         0     2 Sovereign country   1                        Vanuatu     VUT\n8         0     2 Sovereign country   1                     Uzbekistan     UZB\n9         0     2 Sovereign country   1                        Uruguay     URY\n10        0     2 Sovereign country   1 Federated States of Micronesia     FSM\n   geou_dif                        geounit gu_a3 su_dif\n1         0                       Zimbabwe   ZWE      0\n2         0                         Zambia   ZMB      0\n3         0                          Yemen   YEM      0\n4         0                        Vietnam   VNM      0\n5         0                      Venezuela   VEN      0\n6         0                        Vatican   VAT      0\n7         0                        Vanuatu   VUT      0\n8         0                     Uzbekistan   UZB      0\n9         0                        Uruguay   URY      0\n10        0 Federated States of Micronesia   FSM      0\n                          subunit su_a3 brk_diff       name\n1                        Zimbabwe   ZWE        0   Zimbabwe\n2                          Zambia   ZMB        0     Zambia\n3                           Yemen   YEM        0      Yemen\n4                         Vietnam   VNM        0    Vietnam\n5                       Venezuela   VEN        0  Venezuela\n6                         Vatican   VAT        0    Vatican\n7                         Vanuatu   VUT        0    Vanuatu\n8                      Uzbekistan   UZB        0 Uzbekistan\n9                         Uruguay   URY        0    Uruguay\n10 Federated States of Micronesia   FSM        0 Micronesia\n                        name_long brk_a3   brk_name brk_group abbrev postal\n1                        Zimbabwe    ZWE   Zimbabwe      <NA>  Zimb.     ZW\n2                          Zambia    ZMB     Zambia      <NA> Zambia     ZM\n3                           Yemen    YEM      Yemen      <NA>   Yem.     YE\n4                         Vietnam    VNM    Vietnam      <NA>  Viet.     VN\n5                       Venezuela    VEN  Venezuela      <NA>   Ven.     VE\n6                         Vatican    VAT    Vatican      <NA>   Vat.      V\n7                         Vanuatu    VUT    Vanuatu      <NA>   Van.     VU\n8                      Uzbekistan    UZB Uzbekistan      <NA>   Uzb.     UZ\n9                         Uruguay    URY    Uruguay      <NA>   Ury.     UY\n10 Federated States of Micronesia    FSM Micronesia      <NA> F.S.M.    FSM\n                          formal_en                          formal_fr\n1              Republic of Zimbabwe                               <NA>\n2                Republic of Zambia                               <NA>\n3                 Republic of Yemen                               <NA>\n4     Socialist Republic of Vietnam                               <NA>\n5  Bolivarian Republic of Venezuela República Bolivariana de Venezuela\n6         State of the Vatican City                               <NA>\n7               Republic of Vanuatu                               <NA>\n8            Republic of Uzbekistan                               <NA>\n9      Oriental Republic of Uruguay                               <NA>\n10   Federated States of Micronesia                               <NA>\n                        name_ciawf note_adm0 note_brk\n1                         Zimbabwe      <NA>     <NA>\n2                           Zambia      <NA>     <NA>\n3                            Yemen      <NA>     <NA>\n4                          Vietnam      <NA>     <NA>\n5                        Venezuela      <NA>     <NA>\n6          Holy See (Vatican City)      <NA>     <NA>\n7                          Vanuatu      <NA>     <NA>\n8                       Uzbekistan      <NA>     <NA>\n9                          Uruguay      <NA>     <NA>\n10 Micronesia, Federated States of      <NA>     <NA>\n                         name_sort name_alt mapcolor7 mapcolor8 mapcolor9\n1                         Zimbabwe     <NA>         1         5         3\n2                           Zambia     <NA>         5         8         5\n3                      Yemen, Rep.     <NA>         5         3         3\n4                          Vietnam     <NA>         5         6         5\n5                    Venezuela, RB     <NA>         1         3         1\n6               Vatican (Holy See) Holy See         1         3         4\n7                          Vanuatu     <NA>         6         3         7\n8                       Uzbekistan     <NA>         2         3         5\n9                          Uruguay     <NA>         1         2         2\n10 Micronesia, Federated States of     <NA>         5         2         4\n   mapcolor13  pop_est pop_rank pop_year gdp_md gdp_year\n1           9 14645468       14     2019  21440     2019\n2          13 17861030       14     2019  23309     2019\n3          11 29161922       15     2019  22581     2019\n4           4 96462106       16     2019 261921     2019\n5           4 28515829       15     2019 482359     2014\n6           2      825        2     2019    -99     2019\n7           3   299882       10     2019    934     2019\n8           4 33580650       15     2019  57921     2019\n9          10  3461734       12     2019  56045     2019\n10         13   113815        9     2019    401     2018\n                      economy              income_grp fips_10 iso_a2 iso_a2_eh\n1     5. Emerging region: G20           5. Low income      ZI     ZW        ZW\n2   7. Least developed region  4. Lower middle income      ZA     ZM        ZM\n3   7. Least developed region  4. Lower middle income      YM     YE        YE\n4     5. Emerging region: G20  4. Lower middle income      VM     VN        VN\n5     5. Emerging region: G20  3. Upper middle income      VE     VE        VE\n6  2. Developed region: nonG7 2. High income: nonOECD      VT     VA        VA\n7   7. Least developed region  4. Lower middle income      NH     VU        VU\n8        6. Developing region  4. Lower middle income      UZ     UZ        UZ\n9     5. Emerging region: G20  3. Upper middle income      UY     UY        UY\n10       6. Developing region  4. Lower middle income      FM     FM        FM\n   iso_a3 iso_a3_eh iso_n3 iso_n3_eh un_a3 wb_a2 wb_a3   woe_id woe_id_eh\n1     ZWE       ZWE    716       716   716    ZW   ZWE 23425004  23425004\n2     ZMB       ZMB    894       894   894    ZM   ZMB 23425003  23425003\n3     YEM       YEM    887       887   887    RY   YEM 23425002  23425002\n4     VNM       VNM    704       704   704    VN   VNM 23424984  23424984\n5     VEN       VEN    862       862   862    VE   VEN 23424982  23424982\n6     VAT       VAT    336       336   336   -99   -99 23424986  23424986\n7     VUT       VUT    548       548   548    VU   VUT 23424907  23424907\n8     UZB       UZB    860       860   860    UZ   UZB 23424980  23424980\n9     URY       URY    858       858   858    UY   URY 23424979  23424979\n10    FSM       FSM    583       583   583    FM   FSM 23424815  23424815\n                     woe_note adm0_iso adm0_diff adm0_tlc adm0_a3_us adm0_a3_fr\n1  Exact WOE match as country      ZWE      <NA>      ZWE        ZWE        ZWE\n2  Exact WOE match as country      ZMB      <NA>      ZMB        ZMB        ZMB\n3  Exact WOE match as country      YEM      <NA>      YEM        YEM        YEM\n4  Exact WOE match as country      VNM      <NA>      VNM        VNM        VNM\n5  Exact WOE match as country      VEN      <NA>      VEN        VEN        VEN\n6  Exact WOE match as country      VAT      <NA>      VAT        VAT        VAT\n7  Exact WOE match as country      VUT      <NA>      VUT        VUT        VUT\n8  Exact WOE match as country      UZB      <NA>      UZB        UZB        UZB\n9  Exact WOE match as country      URY      <NA>      URY        URY        URY\n10 Exact WOE match as country      FSM      <NA>      FSM        FSM        FSM\n   adm0_a3_ru adm0_a3_es adm0_a3_cn adm0_a3_tw adm0_a3_in adm0_a3_np adm0_a3_pk\n1         ZWE        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE\n2         ZMB        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB\n3         YEM        YEM        YEM        YEM        YEM        YEM        YEM\n4         VNM        VNM        VNM        VNM        VNM        VNM        VNM\n5         VEN        VEN        VEN        VEN        VEN        VEN        VEN\n6         VAT        VAT        VAT        VAT        VAT        VAT        VAT\n7         VUT        VUT        VUT        VUT        VUT        VUT        VUT\n8         UZB        UZB        UZB        UZB        UZB        UZB        UZB\n9         URY        URY        URY        URY        URY        URY        URY\n10        FSM        FSM        FSM        FSM        FSM        FSM        FSM\n   adm0_a3_de adm0_a3_gb adm0_a3_br adm0_a3_il adm0_a3_ps adm0_a3_sa adm0_a3_eg\n1         ZWE        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE\n2         ZMB        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB\n3         YEM        YEM        YEM        YEM        YEM        YEM        YEM\n4         VNM        VNM        VNM        VNM        VNM        VNM        VNM\n5         VEN        VEN        VEN        VEN        VEN        VEN        VEN\n6         VAT        VAT        VAT        VAT        VAT        VAT        VAT\n7         VUT        VUT        VUT        VUT        VUT        VUT        VUT\n8         UZB        UZB        UZB        UZB        UZB        UZB        UZB\n9         URY        URY        URY        URY        URY        URY        URY\n10        FSM        FSM        FSM        FSM        FSM        FSM        FSM\n   adm0_a3_ma adm0_a3_pt adm0_a3_ar adm0_a3_jp adm0_a3_ko adm0_a3_vn adm0_a3_tr\n1         ZWE        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE\n2         ZMB        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB\n3         YEM        YEM        YEM        YEM        YEM        YEM        YEM\n4         VNM        VNM        VNM        VNM        VNM        VNM        VNM\n5         VEN        VEN        VEN        VEN        VEN        VEN        VEN\n6         VAT        VAT        VAT        VAT        VAT        VAT        VAT\n7         VUT        VUT        VUT        VUT        VUT        VUT        VUT\n8         UZB        UZB        UZB        UZB        UZB        UZB        UZB\n9         URY        URY        URY        URY        URY        URY        URY\n10        FSM        FSM        FSM        FSM        FSM        FSM        FSM\n   adm0_a3_id adm0_a3_pl adm0_a3_gr adm0_a3_it adm0_a3_nl adm0_a3_se adm0_a3_bd\n1         ZWE        ZWE        ZWE        ZWE        ZWE        ZWE        ZWE\n2         ZMB        ZMB        ZMB        ZMB        ZMB        ZMB        ZMB\n3         YEM        YEM        YEM        YEM        YEM        YEM        YEM\n4         VNM        VNM        VNM        VNM        VNM        VNM        VNM\n5         VEN        VEN        VEN        VEN        VEN        VEN        VEN\n6         VAT        VAT        VAT        VAT        VAT        VAT        VAT\n7         VUT        VUT        VUT        VUT        VUT        VUT        VUT\n8         UZB        UZB        UZB        UZB        UZB        UZB        UZB\n9         URY        URY        URY        URY        URY        URY        URY\n10        FSM        FSM        FSM        FSM        FSM        FSM        FSM\n   adm0_a3_ua adm0_a3_un adm0_a3_wb     continent region_un          subregion\n1         ZWE        -99        -99        Africa    Africa     Eastern Africa\n2         ZMB        -99        -99        Africa    Africa     Eastern Africa\n3         YEM        -99        -99          Asia      Asia       Western Asia\n4         VNM        -99        -99          Asia      Asia South-Eastern Asia\n5         VEN        -99        -99 South America  Americas      South America\n6         VAT        -99        -99        Europe    Europe    Southern Europe\n7         VUT        -99        -99       Oceania   Oceania          Melanesia\n8         UZB        -99        -99          Asia      Asia       Central Asia\n9         URY        -99        -99 South America  Americas      South America\n10        FSM        -99        -99       Oceania   Oceania         Micronesia\n                    region_wb name_len long_len abbrev_len tiny homepart\n1          Sub-Saharan Africa        8        8          5  -99        1\n2          Sub-Saharan Africa        6        6          6  -99        1\n3  Middle East & North Africa        5        5          4  -99        1\n4         East Asia & Pacific        7        7          5    2        1\n5   Latin America & Caribbean        9        9          4  -99        1\n6       Europe & Central Asia        7        7          4    4        1\n7         East Asia & Pacific        7        7          4    2        1\n8       Europe & Central Asia       10       10          4    5        1\n9   Latin America & Caribbean        7        7          4  -99        1\n10        East Asia & Pacific       10       30          6  -99        1\n   min_zoom min_label max_label   label_x    label_y      ne_id wikidataid\n1         0       2.5       8.0  29.92544 -18.911640 1159321441       Q954\n2         0       3.0       8.0  26.39530 -14.660804 1159321439       Q953\n3         0       3.0       8.0  45.87438  15.328226 1159321425       Q805\n4         0       2.0       7.0 105.38729  21.715416 1159321417       Q881\n5         0       2.5       7.5 -64.59938   7.182476 1159321411       Q717\n6         0       5.0      10.0  12.45342  41.903323 1159321407       Q237\n7         0       4.0       9.0 166.90876 -15.371530 1159321421       Q686\n8         0       3.0       8.0  64.00543  41.693603 1159321405       Q265\n9         0       3.0       8.0 -55.96694 -32.961127 1159321353        Q77\n10        0       5.0      10.0 158.23402   6.887553 1159320691       Q702\n                     name_ar              name_bn\n1                   زيمبابوي             জিম্বাবুয়ে\n2                     زامبيا              জাম্বিয়া\n3                      اليمن               ইয়েমেন\n4                     فيتنام             ভিয়েতনাম\n5                    فنزويلا            ভেনেজুয়েলা\n6                  الفاتيكان        ভ্যাটিকান সিটি\n7                    فانواتو               ভানুয়াতু\n8                  أوزبكستان           উজবেকিস্তান\n9                 الأوروغواي                উরুগুয়ে\n10 ولايات ميكرونيسيا المتحدة মাইক্রোনেশিয়া যুক্তরাজ্য\n                              name_de                        name_en\n1                            Simbabwe                       Zimbabwe\n2                              Sambia                         Zambia\n3                               Jemen                          Yemen\n4                             Vietnam                        Vietnam\n5                           Venezuela                      Venezuela\n6                        Vatikanstadt                   Vatican City\n7                             Vanuatu                        Vanuatu\n8                          Usbekistan                     Uzbekistan\n9                             Uruguay                        Uruguay\n10 Föderierte Staaten von Mikronesien Federated States of Micronesia\n                           name_es  name_fa                     name_fr\n1                         Zimbabue زیمبابوه                    Zimbabwe\n2                           Zambia   زامبیا                      Zambie\n3                            Yemen      یمن                       Yémen\n4                          Vietnam   ویتنام                    Viêt Nam\n5                        Venezuela  ونزوئلا                   Venezuela\n6              Ciudad del Vaticano  واتیکان             Cité du Vatican\n7                          Vanuatu  وانواتو                     Vanuatu\n8                       Uzbekistán ازبکستان                 Ouzbékistan\n9                          Uruguay  اروگوئه                     Uruguay\n10 Estados Federados de Micronesia میکرونزی États fédérés de Micronésie\n                                name_el       name_he                  name_hi\n1                            Ζιμπάμπουε      זימבבואה                  ज़िम्बाब्वे\n2                                Ζάμπια         זמביה                  ज़ाम्बिया\n3                                Υεμένη          תימן                      यमन\n4                               Βιετνάμ       וייטנאם                  वियतनाम\n5                            Βενεζουέλα       ונצואלה                   वेनेज़ुएला\n6                              Βατικανό קריית הוותיקן                वैटिकन नगर\n7                             Βανουάτου        ונואטו                    वानूआटू\n8                          Ουζμπεκιστάν     אוזבקיסטן                उज़्बेकिस्तान\n9                            Ουρουγουάη     אורוגוואי                     उरुग्वे\n10 Ομόσπονδες Πολιτείες της Μικρονησίας     מיקרונזיה माइक्रोनेशिया के संघीकृत राज्य\n                          name_hu    name_id                      name_it\n1                        Zimbabwe   Zimbabwe                     Zimbabwe\n2                          Zambia     Zambia                       Zambia\n3                           Jemen      Yaman                        Yemen\n4                         Vietnám    Vietnam                      Vietnam\n5                       Venezuela  Venezuela                    Venezuela\n6                         Vatikán    Vatikan           Città del Vaticano\n7                         Vanuatu    Vanuatu                      Vanuatu\n8                     Üzbegisztán Uzbekistan                   Uzbekistan\n9                         Uruguay    Uruguay                      Uruguay\n10 Mikronéziai Szövetségi Államok Mikronesia Stati Federati di Micronesia\n            name_ja           name_ko      name_nl    name_pl     name_pt\n1        ジンバブエ          짐바브웨     Zimbabwe   Zimbabwe    Zimbábue\n2          ザンビア            잠비아       Zambia     Zambia      Zâmbia\n3          イエメン              예멘        Jemen      Jemen       Iémen\n4          ベトナム            베트남      Vietnam    Wietnam    Vietname\n5        ベネズエラ        베네수엘라    Venezuela  Wenezuela   Venezuela\n6          バチカン       바티칸 시국 Vaticaanstad    Watykan    Vaticano\n7          バヌアツ          바누아투      Vanuatu    Vanuatu     Vanuatu\n8    ウズベキスタン      우즈베키스탄  Oezbekistan Uzbekistan Uzbequistão\n9        ウルグアイ          우루과이      Uruguay    Urugwaj     Uruguai\n10 ミクロネシア連邦 미크로네시아 연방   Micronesia Mikronezja  Micronésia\n      name_ru                   name_sv    name_tr    name_uk      name_ur\n1    Зимбабве                  Zimbabwe   Zimbabve   Зімбабве      زمبابوے\n2      Замбия                    Zambia    Zambiya     Замбія       زیمبیا\n3       Йемен                     Jemen      Yemen       Ємен          یمن\n4     Вьетнам                   Vietnam    Vietnam    В'єтнам       ویتنام\n5   Венесуэла                 Venezuela  Venezuela  Венесуела    وینیزویلا\n6     Ватикан             Vatikanstaten    Vatikan    Ватикан   ویٹیکن سٹی\n7     Вануату                   Vanuatu    Vanuatu    Вануату      وانواتو\n8  Узбекистан                Uzbekistan Özbekistan Узбекистан     ازبکستان\n9     Уругвай                   Uruguay    Uruguay    Уругвай     یوراگوئے\n10 Микронезия Mikronesiska federationen Mikronezya Мікронезія مائیکرونیشیا\n         name_vi          name_zh         name_zht      fclass_iso tlc_diff\n1       Zimbabwe         津巴布韦           辛巴威 Admin-0 country     <NA>\n2         Zambia           赞比亚           尚比亞 Admin-0 country     <NA>\n3          Yemen             也门             葉門 Admin-0 country     <NA>\n4       Việt Nam             越南             越南 Admin-0 country     <NA>\n5      Venezuela         委内瑞拉         委內瑞拉 Admin-0 country     <NA>\n6  Thành Vatican           梵蒂冈           梵蒂岡 Admin-0 country     <NA>\n7        Vanuatu         瓦努阿图           萬那杜 Admin-0 country     <NA>\n8     Uzbekistan     乌兹别克斯坦         烏茲別克 Admin-0 country     <NA>\n9        Uruguay           乌拉圭           烏拉圭 Admin-0 country     <NA>\n10    Micronesia 密克罗尼西亚联邦 密克羅尼西亞聯邦 Admin-0 country     <NA>\n        fclass_tlc fclass_us fclass_fr fclass_ru fclass_es fclass_cn fclass_tw\n1  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n2  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n3  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n4  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n5  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n6  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n7  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n8  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n9  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n10 Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n   fclass_in fclass_np fclass_pk fclass_de fclass_gb fclass_br fclass_il\n1       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n2       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n3       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n4       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n5       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n6       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n7       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n8       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n9       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n10      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n   fclass_ps fclass_sa fclass_eg fclass_ma fclass_pt fclass_ar fclass_jp\n1       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n2       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n3       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n4       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n5       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n6       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n7       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n8       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n9       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n10      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n   fclass_ko fclass_vn fclass_tr fclass_id fclass_pl fclass_gr fclass_it\n1       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n2       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n3       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n4       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n5       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n6       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n7       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n8       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n9       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n10      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n   fclass_nl fclass_se fclass_bd fclass_ua                       geometry\n1       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((31.28789 -2...\n2       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((30.39609 -1...\n3       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((53.08564 16...\n4       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((104.064 10....\n5       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((-60.82119 9...\n6       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((12.43916 41...\n7       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((166.7458 -1...\n8       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((70.94678 42...\n9       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((-53.37061 -...\n10      <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((162.9832 5....\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(world)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"featurecla\" \"scalerank\"  \"labelrank\"  \"sovereignt\" \"sov_a3\"    \n  [6] \"adm0_dif\"   \"level\"      \"type\"       \"tlc\"        \"admin\"     \n [11] \"adm0_a3\"    \"geou_dif\"   \"geounit\"    \"gu_a3\"      \"su_dif\"    \n [16] \"subunit\"    \"su_a3\"      \"brk_diff\"   \"name\"       \"name_long\" \n [21] \"brk_a3\"     \"brk_name\"   \"brk_group\"  \"abbrev\"     \"postal\"    \n [26] \"formal_en\"  \"formal_fr\"  \"name_ciawf\" \"note_adm0\"  \"note_brk\"  \n [31] \"name_sort\"  \"name_alt\"   \"mapcolor7\"  \"mapcolor8\"  \"mapcolor9\" \n [36] \"mapcolor13\" \"pop_est\"    \"pop_rank\"   \"pop_year\"   \"gdp_md\"    \n [41] \"gdp_year\"   \"economy\"    \"income_grp\" \"fips_10\"    \"iso_a2\"    \n [46] \"iso_a2_eh\"  \"iso_a3\"     \"iso_a3_eh\"  \"iso_n3\"     \"iso_n3_eh\" \n [51] \"un_a3\"      \"wb_a2\"      \"wb_a3\"      \"woe_id\"     \"woe_id_eh\" \n [56] \"woe_note\"   \"adm0_iso\"   \"adm0_diff\"  \"adm0_tlc\"   \"adm0_a3_us\"\n [61] \"adm0_a3_fr\" \"adm0_a3_ru\" \"adm0_a3_es\" \"adm0_a3_cn\" \"adm0_a3_tw\"\n [66] \"adm0_a3_in\" \"adm0_a3_np\" \"adm0_a3_pk\" \"adm0_a3_de\" \"adm0_a3_gb\"\n [71] \"adm0_a3_br\" \"adm0_a3_il\" \"adm0_a3_ps\" \"adm0_a3_sa\" \"adm0_a3_eg\"\n [76] \"adm0_a3_ma\" \"adm0_a3_pt\" \"adm0_a3_ar\" \"adm0_a3_jp\" \"adm0_a3_ko\"\n [81] \"adm0_a3_vn\" \"adm0_a3_tr\" \"adm0_a3_id\" \"adm0_a3_pl\" \"adm0_a3_gr\"\n [86] \"adm0_a3_it\" \"adm0_a3_nl\" \"adm0_a3_se\" \"adm0_a3_bd\" \"adm0_a3_ua\"\n [91] \"adm0_a3_un\" \"adm0_a3_wb\" \"continent\"  \"region_un\"  \"subregion\" \n [96] \"region_wb\"  \"name_len\"   \"long_len\"   \"abbrev_len\" \"tiny\"      \n[101] \"homepart\"   \"min_zoom\"   \"min_label\"  \"max_label\"  \"label_x\"   \n[106] \"label_y\"    \"ne_id\"      \"wikidataid\" \"name_ar\"    \"name_bn\"   \n[111] \"name_de\"    \"name_en\"    \"name_es\"    \"name_fa\"    \"name_fr\"   \n[116] \"name_el\"    \"name_he\"    \"name_hi\"    \"name_hu\"    \"name_id\"   \n[121] \"name_it\"    \"name_ja\"    \"name_ko\"    \"name_nl\"    \"name_pl\"   \n[126] \"name_pt\"    \"name_ru\"    \"name_sv\"    \"name_tr\"    \"name_uk\"   \n[131] \"name_ur\"    \"name_vi\"    \"name_zh\"    \"name_zht\"   \"fclass_iso\"\n[136] \"tlc_diff\"   \"fclass_tlc\" \"fclass_us\"  \"fclass_fr\"  \"fclass_ru\" \n[141] \"fclass_es\"  \"fclass_cn\"  \"fclass_tw\"  \"fclass_in\"  \"fclass_np\" \n[146] \"fclass_pk\"  \"fclass_de\"  \"fclass_gb\"  \"fclass_br\"  \"fclass_il\" \n[151] \"fclass_ps\"  \"fclass_sa\"  \"fclass_eg\"  \"fclass_ma\"  \"fclass_pt\" \n[156] \"fclass_ar\"  \"fclass_jp\"  \"fclass_ko\"  \"fclass_vn\"  \"fclass_tr\" \n[161] \"fclass_id\"  \"fclass_pl\"  \"fclass_gr\"  \"fclass_it\"  \"fclass_nl\" \n[166] \"fclass_se\"  \"fclass_bd\"  \"fclass_ua\"  \"geometry\"  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nworld_map <- world %>% ggplot() + \n      geom_sf()\n\nworld_map + \n  xlab(\"Longitude\") + ylab(\"Latitude\") +\n    ggtitle(\"World map\", subtitle = paste0(\"(\", length(unique(world$name)), \" countries)\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nworld_map + \n  xlab(\"Longitude\") + ylab(\"Latitude\") +\n    ggtitle(\"World map\", subtitle = paste0(\"(\", length(unique(world$name)), \" countries)\")) + \n    geom_sf(aes(fill = pop_est), show.legend=\"point\") +\n    scale_fill_viridis_c(option = \"plasma\", trans = \"sqrt\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\nworld %>% ggplot() + \n      geom_sf(color = \"black\", fill = \"lightgreen\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nusa <- ne_states(country=\"United States of America\", returnclass = \"sf\")\nhead(usa)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 6 features and 121 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -124.7346 ymin: 41.69681 xmax: -82.4146 ymax: 49.36949\nGeodetic CRS:  WGS 84\n                         featurecla scalerank adm1_code diss_me iso_3166_2\n1236 Admin-1 states provinces lakes         2  USA-3519    3519      US-WA\n1238 Admin-1 states provinces lakes         2  USA-3518    3518      US-ID\n1239 Admin-1 states provinces lakes         2  USA-3515    3515      US-MT\n1242 Admin-1 states provinces lakes         2  USA-3516    3516      US-ND\n1244 Admin-1 states provinces lakes         2  USA-3514    3514      US-MN\n1246 Admin-1 states provinces lakes         2  USA-3562    3562      US-MI\n                                           wikipedia iso_a2 adm0_sr\n1236 http://en.wikipedia.org/wiki/Washington_(state)     US       6\n1238              http://en.wikipedia.org/wiki/Idaho     US       1\n1239            http://en.wikipedia.org/wiki/Montana     US       1\n1242       http://en.wikipedia.org/wiki/North_Dakota     US       1\n1244          http://en.wikipedia.org/wiki/Minnesota     US       1\n1246           http://en.wikipedia.org/wiki/Michigan     US       1\n             name name_alt name_local  type type_en code_local code_hasc note\n1236   Washington WA|Wash.       <NA> State   State       US53     US.WA <NA>\n1238        Idaho ID|Idaho       <NA> State   State       US16     US.ID <NA>\n1239      Montana MT|Mont.       <NA> State   State       US30     US.MT <NA>\n1242 North Dakota  ND|N.D.       <NA> State   State       US38     US.ND <NA>\n1244    Minnesota MN|Minn.       <NA> State   State       US27     US.MN <NA>\n1246     Michigan MI|Mich.       <NA> State   State       US26     US.MI <NA>\n     hasc_maybe  region region_cod provnum_ne gadm_level check_me datarank\n1236       <NA>    West       <NA>          0          1       20        1\n1238       <NA>    West       <NA>          0          1       20        1\n1239       <NA>    West       <NA>          0          1       20        1\n1242       <NA> Midwest       <NA>          0          1       20        1\n1244       <NA> Midwest       <NA>          0          1       20        1\n1246       <NA> Midwest       <NA>          0          1       20        1\n     abbrev postal area_sqkm sameascity labelrank name_len mapcolor9 mapcolor13\n1236  Wash.     WA         0        -99         0       10         1          1\n1238  Idaho     ID         0        -99         0        5         1          1\n1239  Mont.     MT         0        -99         0        7         1          1\n1242   N.D.     ND         0        -99         0       12         1          1\n1244  Minn.     MN         0        -99         0        9         1          1\n1246  Mich.     MI         0        -99         0        8         1          1\n     fips fips_alt  woe_id                       woe_label     woe_name\n1236 US53     <NA> 2347606   Washington, US, United States   Washington\n1238 US16     <NA> 2347571        Idaho, US, United States        Idaho\n1239 US30     <NA> 2347585      Montana, US, United States      Montana\n1242 US38     <NA> 2347593 North Dakota, US, United States North Dakota\n1244 US27     <NA> 2347582    Minnesota, US, United States    Minnesota\n1246 US26     <NA> 2347581     Michigan, US, United States     Michigan\n     latitude longitude sov_a3 adm0_a3 adm0_label                    admin\n1236  47.4865 -120.3610    US1     USA          2 United States of America\n1238  43.7825 -114.1330    US1     USA          2 United States of America\n1239  46.9965 -110.0440    US1     USA          2 United States of America\n1242  47.4675 -100.3020    US1     USA          2 United States of America\n1244  46.0592  -93.3640    US1     USA          2 United States of America\n1246  43.4343  -84.9479    US1     USA          2 United States of America\n                     geonunit gu_a3   gn_id      gn_name gns_id gns_name\n1236 United States of America   USA 5815135   Washington     -1     <NA>\n1238 United States of America   USA 5596512        Idaho     -1     <NA>\n1239 United States of America   USA 5667009      Montana     -1     <NA>\n1242 United States of America   USA 5690763 North Dakota     -1     <NA>\n1244 United States of America   USA 5037779    Minnesota     -1     <NA>\n1246 United States of America   USA 5001836     Michigan     -1     <NA>\n     gn_level gn_region gn_a1_code         region_sub sub_code gns_level\n1236        1      <NA>      US.WA            Pacific     <NA>        -1\n1238        1      <NA>      US.ID           Mountain     <NA>        -1\n1239        1      <NA>      US.MT           Mountain     <NA>        -1\n1242        1      <NA>      US.ND West North Central     <NA>        -1\n1244        1      <NA>      US.MN West North Central     <NA>        -1\n1246        1      <NA>      US.MI East North Central     <NA>        -1\n     gns_lang gns_adm1 gns_region min_label max_label min_zoom wikidataid\n1236     <NA>     <NA>       <NA>       3.5       7.5        2      Q1223\n1238     <NA>     <NA>       <NA>       3.5       7.5        2      Q1221\n1239     <NA>     <NA>       <NA>       3.5       7.5        2      Q1212\n1242     <NA>     <NA>       <NA>       3.5       7.5        2      Q1207\n1244     <NA>     <NA>       <NA>       3.5       7.5        2      Q1527\n1246     <NA>     <NA>       <NA>       3.5       7.5        2      Q1166\n             name_ar    name_bn      name_de      name_en          name_es\n1236          واشنطن   ওয়াশিংটন   Washington   Washington       Washington\n1238          أيداهو     আইডাহো        Idaho        Idaho            Idaho\n1239         مونتانا     মন্টানা      Montana      Montana          Montana\n1242 داكوتا الشمالية নর্থ ডাকোটা North Dakota North Dakota Dakota del Norte\n1244        مينيسوتا   মিনেসোটা    Minnesota    Minnesota        Minnesota\n1246         ميشيغان    মিশিগান     Michigan     Michigan         Míchigan\n            name_fr        name_el      name_hi      name_hu      name_id\n1236     Washington    Ουάσινγκτον वॉशिंगटन राज्य   Washington   Washington\n1238          Idaho        Άινταχο       आयडाहो        Idaho        Idaho\n1239        Montana        Μοντάνα      मोन्टाना      Montana      Montana\n1242 Dakota du Nord Βόρεια Ντακότα   उत्तर डेकोटा Észak-Dakota Dakota Utara\n1244      Minnesota       Μινεσότα      मिनेसोटा    Minnesota    Minnesota\n1246       Michigan       Μίσιγκαν       मिशिगन     Michigan     Michigan\n             name_it        name_ja    name_ko      name_nl         name_pl\n1236      Washington   ワシントン州     워싱턴   Washington      Waszyngton\n1238           Idaho     アイダホ州   아이다호        Idaho           Idaho\n1239         Montana     モンタナ州     몬태나      Montana         Montana\n1242 Dakota del Nord ノースダコタ州 노스다코타 Noord-Dakota Dakota Północna\n1244       Minnesota     ミネソタ州   미네소타    Minnesota       Minnesota\n1246        Michigan     ミシガン州     미시간     Michigan        Michigan\n             name_pt         name_ru      name_sv      name_tr    name_vi\n1236      Washington       Вашингтон   Washington    Vaşington Washington\n1238           Idaho          Айдахо        Idaho        Idaho      Idaho\n1239         Montana         Монтана      Montana      Montana    Montana\n1242 Dakota do Norte Северная Дакота North Dakota Kuzey Dakota Bắc Dakota\n1244       Minnesota       Миннесота    Minnesota    Minnesota  Minnesota\n1246        Michigan         Мичиган     Michigan     Michigan   Michigan\n        name_zh      ne_id       name_he         name_uk       name_ur\n1236   华盛顿州 1159309547     וושינגטון       Вашингтон ریاست واشنگٹن\n1238   爱达荷州 1159315339        איידהו          Айдахо        ایڈاہو\n1239   蒙大拿州 1159315333        מונטנה         Монтана       مونٹانا\n1242 北达科他州 1159315337 דקוטה הצפונית Північна Дакота   شمالی ڈکوٹا\n1244 明尼苏达州 1159315297       מינסוטה       Міннесота      مینیسوٹا\n1246   密歇根州 1159314665        מישיגן         Мічиган        مشی گن\n            name_fa   name_zht FCLASS_ISO FCLASS_US FCLASS_FR FCLASS_RU\n1236 ایالت واشینگتن   華盛頓州       <NA>      <NA>      <NA>      <NA>\n1238         آیداهو   愛達荷州       <NA>      <NA>      <NA>      <NA>\n1239  ایالت مونتانا   蒙大拿州       <NA>      <NA>      <NA>      <NA>\n1242  داکوتای شمالی 北達科他州       <NA>      <NA>      <NA>      <NA>\n1244       مینهسوتا 明尼蘇達州       <NA>      <NA>      <NA>      <NA>\n1246        میشیگان   密歇根州       <NA>      <NA>      <NA>      <NA>\n     FCLASS_ES FCLASS_CN FCLASS_TW FCLASS_IN FCLASS_NP FCLASS_PK FCLASS_DE\n1236      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1238      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1239      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1242      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1244      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1246      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n     FCLASS_GB FCLASS_BR FCLASS_IL FCLASS_PS FCLASS_SA FCLASS_EG FCLASS_MA\n1236      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1238      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1239      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1242      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1244      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1246      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n     FCLASS_PT FCLASS_AR FCLASS_JP FCLASS_KO FCLASS_VN FCLASS_TR FCLASS_ID\n1236      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1238      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1239      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1242      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1244      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1246      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n     FCLASS_PL FCLASS_GR FCLASS_IT FCLASS_NL FCLASS_SE FCLASS_BD FCLASS_UA\n1236      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1238      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1239      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1242      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1244      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n1246      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n     FCLASS_TLC                       geometry\n1236       <NA> MULTIPOLYGON (((-122.753 48...\n1238       <NA> MULTIPOLYGON (((-117.0382 4...\n1239       <NA> MULTIPOLYGON (((-116.0482 4...\n1242       <NA> MULTIPOLYGON (((-104.0476 4...\n1244       <NA> MULTIPOLYGON (((-97.22609 4...\n1246       <NA> MULTIPOLYGON (((-84.4913 46...\n```\n\n\n:::\n\n```{.r .cell-code}\nhi <- usa %>% \n    filter(name %in% \"Hawaii\")\n\nggplot(hi) + geom_sf()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data=usa) + \n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplants_sf <- read_sf(\"Threatened-Endangered_Plants/Threatened-Endangered_Plants.shp\")\n\nprint(plants_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 295 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 418663.1 ymin: 2094235 xmax: 940279.3 ymax: 2458614\nProjected CRS: NAD83(HARN) / UTM zone 4N\n# A tibble: 295 × 5\n   objectid density st_areasha st_perimet                               geometry\n      <int> <chr>        <dbl>      <dbl>                          <POLYGON [m]>\n 1        1 O       486756841.    529043. ((458315.8 2458250, 458323.8 2458261,…\n 2        2 O         1902211.     10318. ((442761.6 2457820, 442825.4 2457776,…\n 3        3 VH       91796978.     55012. ((439743.9 2457337, 439749.5 2457315,…\n 4        4 M       327957790.    178672. ((442266 2457081, 442399.4 2457054, 4…\n 5        5 O         3303196.     21531. ((445019.8 2456927, 445048.5 2456954,…\n 6        6 L         5716987.     19788. ((454844.9 2452549, 454657 2452625, 4…\n 7        7 O           93867.      1576. ((435817.1 2454756, 435799.7 2454719,…\n 8        8 L         1422708.      6576. ((457829.4 2452003, 457570.8 2451935,…\n 9        9 O         1274152.      5524. ((433566.3 2452939, 433550 2452773, 4…\n10       10 M        21326155.     56140. ((425412.9 2449482, 425419.3 2449480,…\n# ℹ 285 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nst_geometry(plants_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeometry set for 295 features \nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 418663.1 ymin: 2094235 xmax: 940279.3 ymax: 2458614\nProjected CRS: NAD83(HARN) / UTM zone 4N\nFirst 5 geometries:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPOLYGON ((458315.8 2458250, 458323.8 2458261, 4...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPOLYGON ((442761.6 2457820, 442825.4 2457776, 4...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPOLYGON ((439743.9 2457337, 439749.5 2457315, 4...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPOLYGON ((442266 2457081, 442399.4 2457054, 442...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPOLYGON ((445019.8 2456927, 445048.5 2456954, 4...\n```\n\n\n:::\n\n```{.r .cell-code}\nold_sf <- read_sf(\"USGS_Quads_(Old_Hawaiian_Datum)/USGS_Quads_(Old_Hawaiian_Datum).shp\")\n\nprint(old_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 128 features and 5 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 367593.4 ymin: 2089668 xmax: 946763.1 ymax: 2459366\nProjected CRS: NAD83(HARN) / UTM zone 4N\n# A tibble: 128 × 6\n   objectid qname         qnum  st_areasha st_perimet                   geometry\n      <int> <chr>         <chr>      <dbl>      <dbl>              <POLYGON [m]>\n 1        1 HAENA         K03   178152007.     53420. ((431559.5 2452918, 43159…\n 2        2 HANALEI       K06   178109861.     53416. ((444471.9 2459311, 45735…\n 3        3 ANAHOLA       K09   178076759.     53411. ((457315.4 2445444, 45735…\n 4        4 MAKAHA POINT  K01   178290448.     53441. ((418674 2452974, 431559.…\n 5        5 WAIMEA CANYON K04   178470118.     53467. ((431529.2 2445543, 44442…\n 6        6 WAIALEALE     K07   178392925.     53458. ((444422.5 2445489, 45731…\n 7        7 KAPAA         K10   178336247.     53449. ((457315.4 2445444, 47020…\n 8        8 KEKAHA        K02   178551324.     53480. ((418602.1 2439147, 43149…\n 9        9 NIIHAU NORTH  N01   380920692.     81144. ((367716.3 2421892, 36783…\n10       10 HANAPEPE      K05   178659961.     53495. ((431468.3 2431707, 44437…\n# ℹ 118 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(old_sf)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n:::\n\n\n\n## NG map\n\n\n::: {.cell}\n\n```{.r .cell-code}\nng_sf <- ne_countries(country = \n            c(\n              \"Papua New Guinea\", \n              \"Indonesia\", \n              \"Philippines\"\n            ), \n            scale=50, \n            returnclass=\"sf\")\nprint(ng_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 3 features and 168 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 95.20664 ymin: -11.63057 xmax: 155.9576 ymax: 20.84126\nGeodetic CRS:  WGS 84\n         featurecla scalerank labelrank       sovereignt sov_a3 adm0_dif level\n81  Admin-0 country         1         2      Philippines    PHL        0     2\n84  Admin-0 country         1         2 Papua New Guinea    PNG        0     2\n144 Admin-0 country         3         2        Indonesia    IDN        0     2\n                 type tlc            admin adm0_a3 geou_dif          geounit\n81  Sovereign country   1      Philippines     PHL        0      Philippines\n84  Sovereign country   1 Papua New Guinea     PNG        0 Papua New Guinea\n144 Sovereign country   1        Indonesia     IDN        0        Indonesia\n    gu_a3 su_dif          subunit su_a3 brk_diff             name\n81    PHL      0      Philippines   PHL        0      Philippines\n84    PNG      1 Papua New Guinea   PN1        0 Papua New Guinea\n144   IDN      0        Indonesia   IDN        0        Indonesia\n           name_long brk_a3         brk_name brk_group abbrev postal\n81       Philippines    PHL      Philippines      <NA>  Phil.     PH\n84  Papua New Guinea    PN1 Papua New Guinea      <NA> P.N.G.     PG\n144        Indonesia    IDN        Indonesia      <NA>  Indo.   INDO\n                                formal_en formal_fr       name_ciawf note_adm0\n81            Republic of the Philippines      <NA>      Philippines      <NA>\n84  Independent State of Papua New Guinea      <NA> Papua New Guinea      <NA>\n144                 Republic of Indonesia      <NA>        Indonesia      <NA>\n    note_brk        name_sort name_alt mapcolor7 mapcolor8 mapcolor9 mapcolor13\n81      <NA>      Philippines     <NA>         3         2         2          8\n84      <NA> Papua New Guinea     <NA>         4         2         3          1\n144     <NA>        Indonesia     <NA>         6         6         6         11\n      pop_est pop_rank pop_year  gdp_md gdp_year                  economy\n81  108116615       17     2019  376795     2019  5. Emerging region: G20\n84    8776109       13     2019   24829     2019     6. Developing region\n144 270625568       17     2019 1119190     2019 4. Emerging region: MIKT\n                income_grp fips_10 iso_a2 iso_a2_eh iso_a3 iso_a3_eh iso_n3\n81  4. Lower middle income      RP     PH        PH    PHL       PHL    608\n84  4. Lower middle income      PP     PG        PG    PNG       PNG    598\n144 4. Lower middle income      ID     ID        ID    IDN       IDN    360\n    iso_n3_eh un_a3 wb_a2 wb_a3   woe_id woe_id_eh                   woe_note\n81        608   608    PH   PHL 23424934  23424934 Exact WOE match as country\n84        598   598    PG   PNG 23424926  23424926 Exact WOE match as country\n144       360   360    ID   IDN 23424846  23424846 Exact WOE match as country\n    adm0_iso adm0_diff adm0_tlc adm0_a3_us adm0_a3_fr adm0_a3_ru adm0_a3_es\n81       PHL      <NA>      PHL        PHL        PHL        PHL        PHL\n84       PN1      <NA>      PN1        PNG        PNG        PNG        PNG\n144      IDN      <NA>      IDN        IDN        IDN        IDN        IDN\n    adm0_a3_cn adm0_a3_tw adm0_a3_in adm0_a3_np adm0_a3_pk adm0_a3_de\n81         PHL        PHL        PHL        PHL        PHL        PHL\n84         PNG        PNG        PNG        PNG        PNG        PNG\n144        IDN        IDN        IDN        IDN        IDN        IDN\n    adm0_a3_gb adm0_a3_br adm0_a3_il adm0_a3_ps adm0_a3_sa adm0_a3_eg\n81         PHL        PHL        PHL        PHL        PHL        PHL\n84         PNG        PNG        PNG        PNG        PNG        PNG\n144        IDN        IDN        IDN        IDN        IDN        IDN\n    adm0_a3_ma adm0_a3_pt adm0_a3_ar adm0_a3_jp adm0_a3_ko adm0_a3_vn\n81         PHL        PHL        PHL        PHL        PHL        PHL\n84         PNG        PNG        PNG        PNG        PNG        PNG\n144        IDN        IDN        IDN        IDN        IDN        IDN\n    adm0_a3_tr adm0_a3_id adm0_a3_pl adm0_a3_gr adm0_a3_it adm0_a3_nl\n81         PHL        PHL        PHL        PHL        PHL        PHL\n84         PNG        PNG        PNG        PNG        PNG        PNG\n144        IDN        IDN        IDN        IDN        IDN        IDN\n    adm0_a3_se adm0_a3_bd adm0_a3_ua adm0_a3_un adm0_a3_wb continent region_un\n81         PHL        PHL        PHL        -99        -99      Asia      Asia\n84         PNG        PNG        PNG        -99        -99   Oceania   Oceania\n144        IDN        IDN        IDN        -99        -99      Asia      Asia\n             subregion           region_wb name_len long_len abbrev_len tiny\n81  South-Eastern Asia East Asia & Pacific       11       11          5  -99\n84           Melanesia East Asia & Pacific       16       16          6  -99\n144 South-Eastern Asia East Asia & Pacific        9        9          5  -99\n    homepart min_zoom min_label max_label  label_x   label_y      ne_id\n81         1        0       2.5       7.0 122.4650 11.198000 1159321169\n84         1        0       2.5       7.5 143.9102 -5.695285 1159321173\n144        1        0       1.7       6.7 101.8929 -0.954404 1159320845\n    wikidataid             name_ar       name_bn         name_de\n81        Q928             الفلبين      ফিলিপাইন     Philippinen\n84        Q691 بابوا غينيا الجديدة পাপুয়া নিউগিনি Papua-Neuguinea\n144       Q252           إندونيسيا    ইন্দোনেশিয়া      Indonesien\n             name_en            name_es       name_fa                   name_fr\n81       Philippines          Filipinas       فیلیپین               Philippines\n84  Papua New Guinea Papúa Nueva Guinea پاپوآ گینه نو Papouasie-Nouvelle-Guinée\n144        Indonesia          Indonesia       اندونزی                 Indonésie\n               name_el           name_he      name_hi         name_hu\n81          Φιλιππίνες        הפיליפינים     फ़िलीपीन्स  Fülöp-szigetek\n84  Παπούα Νέα Γουινέα פפואה גינאה החדשה पापुआ न्यू गिनी Pápua Új-Guinea\n144          Ινδονησία         אינדונזיה     इंडोनेशिया       Indonézia\n         name_id            name_it            name_ja      name_ko\n81      Filipina          Filippine         フィリピン       필리핀\n84  Papua Nugini Papua Nuova Guinea パプアニューギニア 파푸아뉴기니\n144    Indonesia          Indonesia       インドネシア   인도네시아\n                name_nl           name_pl          name_pt              name_ru\n81           Filipijnen          Filipiny        Filipinas            Филиппины\n84  Papoea-Nieuw-Guinea Papua-Nowa Gwinea Papua-Nova Guiné Папуа — Новая Гвинея\n144           Indonesië         Indonezja        Indonésia            Индонезия\n             name_sv         name_tr           name_uk       name_ur\n81      Filippinerna      Filipinler         Філіппіни        فلپائن\n84  Papua Nya Guinea Papua Yeni Gine Папуа Нова Гвінея پاپوا نیو گنی\n144       Indonesien       Endonezya         Індонезія     انڈونیشیا\n             name_vi        name_zh       name_zht      fclass_iso tlc_diff\n81       Philippines         菲律宾         菲律賓 Admin-0 country     <NA>\n84  Papua New Guinea 巴布亚新几内亚 巴布亞紐幾內亞 Admin-0 country     <NA>\n144        Indonesia     印度尼西亚     印度尼西亞 Admin-0 country     <NA>\n         fclass_tlc fclass_us fclass_fr fclass_ru fclass_es fclass_cn fclass_tw\n81  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n84  Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n144 Admin-0 country      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n    fclass_in fclass_np fclass_pk fclass_de fclass_gb fclass_br fclass_il\n81       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n84       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n144      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n    fclass_ps fclass_sa fclass_eg fclass_ma fclass_pt fclass_ar fclass_jp\n81       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n84       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n144      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n    fclass_ko fclass_vn fclass_tr fclass_id fclass_pl fclass_gr fclass_it\n81       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n84       <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n144      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>      <NA>\n    fclass_nl fclass_se fclass_bd fclass_ua                       geometry\n81       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((121.1016 18...\n84       <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((152.9658 -4...\n144      <NA>      <NA>      <NA>      <NA> MULTIPOLYGON (((97.48154 1....\n```\n\n\n:::\n\n```{.r .cell-code}\nnrow(ng_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(ng_sf$geometry)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nngp <- ggplot(ng_sf) +\n  geom_sf(color = \"grey80\", fill = \"#f2f2f2\", linewidth = 0.25) +\n  coord_sf(xlim = c(120, 154), ylim = c(-12, 10)) +\n  theme( axis.title = element_blank(),\n         panel.background = element_rect(fill = \"lightblue\", colour = NA)\n       )\n```\n:::\n\n\n\n\n## Add points to map - first get data\n\nMy metadata file contains many genera that I am not interested in so first I filter by genus of interest. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- read.csv(\"https://raw.githubusercontent.com/mbutler808/rclass-2025/refs/heads/main/posts/2025-05-01-spatial/metadata.csv\")\n\nodat <- d %>% filter(genus==\"Oreophryne\")\nadat <- d %>% filter(genus==\"Auparoparo\"|genus==\"Aphantophryne\")\n```\n:::\n\n\nI make two separate datasets just by choice and for convenience to plot them in different colors later. I could also do it by keeping it together and filtering, personal choice. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# convert to sf\nosf <- st_as_sf(odat, coords=c(\"longitude\", \"latitude\"))\nasf <- st_as_sf(adat, coords=c(\"longitude\", \"latitude\"))\n```\n:::\n\n\nMap with points in different shapes and colors. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nngpdat <- ngp +\n  geom_point(data=adat, \n    aes(x=longitude, y=latitude), \n    colour=\"red\", \n    pch=\"+\", \n    size=8, \n    alpha=.75) +\n  geom_point(data=odat, \n    aes(x=longitude, y=latitude), \n    colour=\"grey50\", \n    fill=\"blue\", \n    pch=24, \n    size=2, \n    alpha=.75) \n```\n:::\n\n\n\n### Want to make a zoomed-in inset - identify coordinates\n\n\n::: {.cell}\n\n```{.r .cell-code}\nngpdat +\n  geom_hline(yintercept = -8.75, lty = 2, colour = \"red\") +\n  geom_hline(yintercept = -12, lty = 2, colour = \"red\") +\n  geom_vline(xintercept = 147, lty = 2, colour = \"red\") +\n  geom_vline(xintercept = 155, lty = 2, colour = \"red\") \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n### Annotate plot with a rectangle using the coordinates    \n\n\n::: {.cell}\n\n```{.r .cell-code}\nngpdat <- ngpdat +\n  annotate(\"rect\", xmin = 149, xmax = 154.5, ymin = -12, ymax = -8.75, color = \"grey50\", fill = NA) +\n  theme_void() +\n  theme(axis.title = element_blank(),\n        panel.background = element_rect(fill = \"lightblue\", colour = NA)\n        )\n```\n:::\n\n\n### Make inset - basically another plot zoomed in\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninset <-  \n  ggplot(ng_sf) + \n  geom_sf(color = \"grey70\", fill = \"#f2f2f2\", linewidth = 0.25) +\n  coord_sf(xlim = c(149, 154.5), ylim = c(-12, -8.75), expand=FALSE) + #expand=F prevents ggplot from expanding slightly beyond the limits\n  filter(d, genus==\"Auparoparo\" & (latitude > -12 &\n    latitude < -8.75 &\n    longitude > 149 & \n    longitude < 154.5) \n    ) %>% geom_point( \n      mapping = aes(x=longitude, y=latitude), \n      color=\"red\", \n      pch=\"+\", \n      size=8, \n      alpha=.75) +\n  filter(d, genus==\"Oreophryne\" & (latitude > -12 &\n    latitude < -8.75 &\n    longitude > 149 & \n    longitude < 154.5) \n    ) %>%geom_point(\n        mapping = aes(x=longitude, y=latitude), \n        colour=\"grey50\", \n      fill=\"blue\", \n      pch=24, \n      size=3, \n      alpha=.75) +\n  annotate(\"rect\", xmin = 149, xmax = 154.5, ymin = -12, ymax = -8.75, color = \"grey50\", fill=NA, linewidth=1.5) +\n  labs(x = NULL, y = NULL) + \n  xlim(149, 154.5) +\n  ylim(-12, -8.75) +\n  theme_void() +\n  theme(axis.title = element_blank(),\n        panel.background = element_rect(fill = \"lightblue\", colour = NA)) +\n  guides(size = \"none\") \n```\n:::\n\n\n### Plot the baseplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbaseplot <- ngpdat + \n  geom_sf_text(aes(label=name_en),\n    size = 3,\n    fontface = \"bold\",\n    family = \"serif\",\n    color = \"grey30\",\n    nudge_x = c(0,0,25),\n    nudge_y = c(0,0,-4)) +\n  #Add scale bar to bottom left from ggspatial\n    annotation_scale(location = \"bl\", \n      height = unit(.25, \"cm\"), \n      pad_x = unit(0.3, \"in\"), \n      pad_y = unit(0.3, \"in\")) +\n    #Add north arrow to bottom left from ggspatial\n    annotation_north_arrow(height = unit(1, \"cm\"), \n      width = unit(1, \"cm\"),\n      which_north = \"true\", \n      location = \"bl\", \n      pad_x = unit(2, \"in\"), \n      pad_y = unit(0.5, \"in\")) \n```\n:::\n\n\nI will use the grid package to make an inset with the viewport function. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nvp <- viewport( x=0.75,   # from grid package\n        y=0.75,\n                width=unit(3, \"inches\"),\n                height=unit(2,\"inches\"))\ngrid.show.viewport(vp)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\nprint(baseplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not\ngive correct results for longitude/latitude data\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(inset, vp = viewport(0.75, 0.78, width = 0.4, height = 0.4))  \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n:::\n\n\n### Write to an external file \n\nThere are two print statements here after starting the png device (you can also turn on a pdf if you wish)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheight=6\nwidth=9\n\npng(file=\"map.png\", # for png format you have to specify \n                    # size and resolution\n    height=height, \n    width=width, \n    units=\"in\", \n    res=300)\n      print(baseplot) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not\ngive correct results for longitude/latitude data\n```\n\n\n:::\n\n```{.r .cell-code}\n      print(inset, vp = viewport(0.75, 0.78, width = 0.4, height = 0.4))  \ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nquartz_off_screen \n                2 \n```\n\n\n:::\n:::\n\n\n\n# Cool tip! \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscales::show_col(c(\"#9DBF9E\", \"#A84268\", \"#FCB97D\", \"#C0BCB5\", \"#4A6C6F\", \"#FF5E5B\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n\n\n# Great Mapping Blogs\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}